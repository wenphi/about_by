function [c,ck]=nurbsinit(u,w,d,i)
m11=getx(u,i+3,1)^2/(getx(u,i+2,2)*getx(u,i+1,3));
m13=(getx(u,i+2,1))^2/(getx(u,i+2,2)*getx(u,i+2,3));
m23=3*(getx(u,i+3,1)*getx(u,i+2,1))/(getx(u,i+2,2)*getx(u,i+2,3));
m33=3*(getx(u,i+2,1)*getx(u,i+3,1))/(getx(u,i+2,2)*getx(u,i+2,3));
m44=(getx(u,i+3,1)^2)/(getx(u,i+3,2)*getx(u,i+2,3));%%%
m43=-((m33/3)+m44+(getx(u,i+3,2)^2)/(getx(u,i+3,2)*getx(u,i+2,3)));
m12=1-m11-m13;
m21=-3*m11;
m22=3*(m11-m23);
m31=3*m11;
m32=-3*(m11+m33);
m41=-m11;
m42=m11-m43-m44;
m14=0;
m24=0;
m34=0;

c(1,:)=m11*w(:,i)*d(i,:)+m12*w(:,i+1)*d(i+1,:)+m13*w(:,i+2)*d(i+2,:)+m14*w(:,i+3)*d(i+3,:);
c(2,:)=m21*w(:,i)*d(i,:)+m22*w(:,i+1)*d(i+1,:)+m23*w(:,i+2)*d(i+2,:)+m24*w(:,i+3)*d(i+3,:);
c(3,:)=m31*w(:,i)*d(i,:)+m32*w(:,i+1)*d(i+1,:)+m33*w(:,i+2)*d(i+2,:)+m34*w(:,i+3)*d(i+3,:);
c(4,:)=m41*w(:,i)*d(i,:)+m42*w(:,i+1)*d(i+1,:)+m43*w(:,i+2)*d(i+2,:)+m44*w(:,i+3)*d(i+3,:);
ck(1,:)=m11*w(:,i)+m12*w(:,i+1)+m13*w(:,i+2)+m14*w(:,i+3);
ck(2,:)=m21*w(:,i)+m22*w(:,i+1)+m23*w(:,i+2)+m24*w(:,i+3);
ck(3,:)=m31*w(:,i)+m32*w(:,i+1)+m33*w(:,i+2)+m34*w(:,i+3);
ck(4,:)=m41*w(:,i)+m42*w(:,i+1)+m43*w(:,i+2)+m44*w(:,i+3);

end